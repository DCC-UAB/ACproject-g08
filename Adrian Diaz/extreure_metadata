import pandas as pd 
import numpy as np

df1 = pd.read_csv('./Data/movies_metadata.csv')
print(type(df1))

def metadata_searcher(movieIds: list, df1):
    metadatas = {}
    for movieId in movieIds:
        try:
            metadata = df1[df1['id'] == movieId]
            metadatas[movieId] = metadata

            col_order = ['title', 'id', 'genres', 'popularity', 'release_date', 'vote_average', 'vote_count']
            col_names = ['Títol', 'ID', 'Gèneres', 'Popularitat', 'Data de llançament', 'Mitjana de vots', 'Número de vots']

            for col, nom in zip(col_order, col_names):
                val = metadata.iloc[0][col]
                print(f"{nom}: {val}") 
        except:
            if type(movieId) == int:
                print('Error: La ID de pel·lícula ha de ser format String (no Int)')   
            elif len(movieId) > 0:    
                print(f"Error: No s'ha pogut trobar metadata per la pel·lícula amb ID: {movieId}")
            else:
                print("Error: ID de pel·lícula nul no vàlid")
        print()

    return metadatas

# metadata_searcher(['862', '21032', '', '31', '9598', 70], df1)

def ratings_per_pelicula(dataset):
    #Dataset -> Direcció del dataset
    #Return -> Dict{MovieId: ratings_count}
    ratings = pd.read_csv(dataset)
    cuenta = {}
    for index, row in ratings.iterrows():
        movie = int(row["movieId"])
        # if movie not in cuenta:
        #     cuenta[movie] = 0
        # cuenta[movie] += 1
        cuenta[movie] = cuenta.get(movie, 0) + 1
    return cuenta

# print(ratings_per_pelicula('./Data/ratings_small.csv'))